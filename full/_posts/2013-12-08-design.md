---
layout: post
title: "Design"
---

In this document I'll describe the design of Multilatex, a collaborative web
editor for Latex projects. This is what I've chosen to develop as my practical
project in my second year of my master's degree studies at [FCS][fcs].

## Key audience

The main audience will be people who have used Latex before and want to move to
the cloud and/or want better collaboration.

## Inspiration

* **[GitHub][github]**
* **[Speaker Deck][speaker-deck]**
* **[ShareLaTeX][sharelatex]**
* **[Scribd][scribd]**
* **[Medium][medium]**

## Features

### Landing page

The landing page will be the first page and its purpose is to explain as fast as
possible what the web site does and to convince users to give it a try.

The main feature will be a jumbotron with a few big words, a shot description, a
screenshot of the editor, and a sign up button.

This will be followed by columns showcasing some important features.

Other things to consider:
* Fast sign in and registration.
* A video tutorial of the site and editor.
* Social icons, especially the GitHub one.
* Maybe testimonials in the future.

### Editor

The editor page is where users will spend most of their time. It will be a
single page app with the menu at the top. The editor is only accessible to
projects you have access to.

The editor will occupy the full-width of the page and it will feature a more
compact estethic.

The workspace will consist of multiple windows:
* the file viewer;
* the text editor;
* the PDF output;
* the compilation output;
* and maybe others.

Any of these can be hidden and their size can be modified. There will be a menu
that will deal with organizing the workspace.

The text editor will also have a menu that will deal with its settings (tab
size, font size, color theme and others).

### File management

A project can contain multiple files. Primarily it contains `.tex` files and
then image resource files, but others are also possible. I need to set a limit
on the size of files and projects.

The file viewer in the editor will have to contain a tree structure for listing
and manipulating the files.

### History

Every project will have a history of commits. The latest commit is the default
state of the project (but previous ones can be seen).

The editor always works on the most recent state of the project which is called
the head. The head is always private.

History manipulations are:
* committing, which adds the head as a new state and the head stays intact;
* reverting, which adds a previous state as a new state and the head becomes
that;
* merging, which adds the latest state from another project as a new state and
the head becomes that;
* cherry-picking (in the future), which only merges specific parts;
* deleting, which removes one of the states.

A user can issue a pull request to another project (requesting the merger of his
project). Also, a user can always merge other projects into his.

### File and commit comparisons

There will be a page that will show differences between two arbitrary files
(even across projects and commits) and between all the files in two arbitrary
commits.

This will be useful for reviewing before merging.

### Importing and exporting

There will always be the options to download a commit as a ZIP file, and to
create a new project by uploading a ZIP.

### Comments

One of the key requirements is support for comments. One idea is to use the
[todonotes][todonotes] package so that they are included in the PDF and maybe
also listing them separately.

### Gallery

The gallery will be the showcasing of the popular projects. It's purpose, in a
way, is to demonstrate to users the power of the site by listing some of the
best projects.

I haven't decided on any popularity metric, but it should take into account the
number of contributors, commits, clones, comments, stars, downloads, and views.

The gallery should probably be navigable as a list and as a grid. The grid would
include the project name, author, stars and the biggest element would be a large
thumbnail of the rendered pages. This should be a dynamic thumbnail similar to
[Speaker Deck][speaker-deck].

### Templates

Templates will be projects (belonging to the site) that are meant to be cloned
to provide a starting point for new projects.

### User pages

I do not intend to make a site with social-like features so the page for a user
will only be a listing of his public metadata, projects and activity.

### Notifications

The user tab will list all the notifications for a user. The main notifications
will be pull requests.

### Administration

On the web site side, I don't plan on having many admin features. Maybe just
banning users in case of bad behavior.

On the OS side, I will have to have some tools to manage deployment, migration,
the Latex tools and other such things.

### Other features

The site will require minimal data input from users. What I mean by that is that
it should have sensible defaults to most things and should always be open to
altering them.

I should also consider adding a tutorial page for Latex for people who have
never used it. It could be a source of incoming links.

## Site structure

The site will always have a menu on top. Registered users will have a tab with
their name aligned to the right from where they can manage their account.

### Navigation

General ideas:

* The main page will lead to signing in, signing up or browsing projects.

* Signing in will lead you to your page, or whichever page you were on when you
clicked on signing in.

* Signing up will also lead to your page, but if you have no projects it will
also show a short tutorial.

### URL design

I believe [URL design][url-design] is important and I love how sites like GitHub
have rememberable URLs. For example, `paul-nechifor` is my username and
`reddit-cloud` is one of my projects, so the URL for the repo is simply
`github.com/paul-nechifor/reddit-cloud`. This poses the problem of collisions,
but it can be solved [reserving a list of usernames][reserved-usernames].

Some ideas:

* `/` will be the landing page.

* `/:user` will the user page for `:user`.

* `/:user?tab=projects` will list the projects of `:user`.

* `/:user/:project` will be the project page for `:project`.

* `/:user/:project/edit` will be the editor page for `:project`.

* `/:user/:project/download/pdf` will download the PDF file.

* `/:user/:project/commits` will list all the commits.

* `/:user/:project/commit/:number/download/zip` will download commit `:number`
as a ZIP file.

* `/browse` will show the gallery overview.

* `/browse?cat=templates` will list templates.

* `/browse?ord=new` will list the newest projects.

## Non-functional requirements

These are some other things I need to consider.

### Mobile devices

Since the site will have a complex workflow, I do not intend to make some parts
accessible for mobile devices. In particular, this means the editor.

But some functionalities have to be mobile ready:
* the landing page;
* authentication;
* browsing, viewing and downloading documents.

### Metrics

I'll use [Google Analytics][google-analytics] to measure usage and traffic.

### Stylistic choices

I'll be going with flat design, mostly because I like clean design, but not to
the point of complete lack of affordances. To this end I'll be using [Bootstrap
3][bootstrap] with some tweaking. I may, however, choose a particular theme if I
find one.

## Technical specifications

The project I'm planning is quite complex so choosing the right technologies is
important.

### Stack

This is the web stack I intend to use:

* **[Ubuntu Server][ubuntu-server]** — Linux is an obvious choice and Ubuntu
Server has many easy to install packages.

* **[Node][node]** — A good mix of fast, dynamic and stable.

* **[Express][express]** — The best framework for Node.

* **[Jade][jade]** — Nice templates with beautiful syntax.

* **[Stylus][stylus]** — Powerful, and again, with beautiful syntax.

* **[MongoDB][mongodb]** — I'm not very sold on NoSQL, particularly because of
the lack of transactions, but on the other hand drivers for other databases in
Node aren't very feature rich and prototyping will be faster without schemas.

### Front-end libraries

* **[Bootstrap 3][bootstrap]**

* **[jQuery][jquery]**

* **[Ace][ace]**

* **[Handlebars][handlebars]**

[github]: https://github.com/
[speaker-deck]: https://speakerdeck.com/
[sharelatex]: https://www.sharelatex.com/
[scribd]: http://www.scribd.com/
[medium]: https://medium.com/
[fcs]: http://www.infoiasi.ro/
[url-design]: http://warpspire.com/posts/url-design/
[reserved-usernames]: https://gist.github.com/caseyohara/1453705
[bootstrap]: http://getbootstrap.com/
[ubuntu-server]: http://www.ubuntu.com/server/
[node]: http://nodejs.org/
[express]: http://expressjs.com/
[jade]: http://jade-lang.com/
[stylus]: http://learnboost.github.io/stylus/
[mongodb]: http://www.mongodb.org/
[jquery]: http://jquery.com/
[ace]: http://ace.c9.io/
[handlebars]: http://handlebarsjs.com/
[todonotes]: http://www.tex.ac.uk/ctan/macros/latex/contrib/todonotes/todonotes.pdf
[google-analytics]: http://www.google.com/analytics/
